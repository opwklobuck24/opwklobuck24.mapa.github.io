<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mapa Szlaku Bitwy pod Mokrą</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <style>
        body { margin: 0; padding: 0; }
        #map-container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 10px; overflow: visible !important; position: relative !important; z-index: 1000 !important; }
        #map { width: 100% !important; height: 600px !important; border: 2px solid #2e5b2e; border-radius: 8px; position: relative !important; z-index: 1000 !important; overflow: visible !important; }
        .leaflet-control-attribution { display: none !important; } /* Ukrywa kontrolkę atrybucji */
        .attribution { 
            font-size: 8px; 
            text-align: center; 
            margin-top: 20px; 
            margin-bottom: 10px; 
            color: #666; 
            opacity: 0.7; 
        } /* Styl dla tekstu licencji - mniejszy i mniej inwazyjny */
        @media only screen and (max-width: 768px) {
            #map-container { padding: 5px; }
            #map { height: 50vh !important; min-height: 300px !important; }
            .attribution { font-size: 7px; margin-top: 15px; } /* Mniejsza czcionka na mniejszych ekranach */
        }
        @media only screen and (max-width: 480px) {
            #map { height: 40vh !important; min-height: 250px !important; }
            .attribution { font-size: 6px; margin-top: 10px; } /* Jeszcze mniejsza czcionka na małych ekranach */
        }
    </style>
</head>
<body>
    <div id="map-container">
        <div id="map"></div>
        <div class="attribution">Map data © <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</div>
    </div>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof L === 'undefined') {
                console.error('Leaflet library failed to load. Check the network or CDN.');
                return;
            }
            var mapContainer = document.getElementById('map');
            if (!mapContainer) {
                console.error('Map container (#map) not found in the DOM.');
                return;
            }
            try {
                var map = L.map('map', {
                    center: [50.96, 18.92],
                    zoom: 13,
                    zoomControl: true,
                    minZoom: 10,
                    maxBounds: [[50.8, 18.7], [51.1, 19.1]],
                    maxBoundsViscosity: 1.0,
                    touchZoom: true,
                    scrollWheelZoom: false,
                    doubleClickZoom: true
                });
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 19
                }).addTo(map);
                var points = [
                    {lat: 50.958865, lng: 18.918025, title: '1. Pomnik'},
                    {lat: 50.959774, lng: 18.915518, title: '2. Kościółek'},
                    {lat: 50.959119, lng: 18.909834, title: '3. Dąb rtm. Hollaka'},
                    {lat: 50.948858, lng: 18.889433, title: '4. I linia obrony'},
                    {lat: 50.958209, lng: 18.926947, title: '5. Walka 2.DAK'},
                    {lat: 50.962619, lng: 18.931671, title: '6. 12.PUł. i PP nr 53. „Śmiały”'},
                    {lat: 50.970341, lng: 18.969325, title: '7. Miedźno - mogiła zbiorowa'},
                    {lat: 50.988265, lng: 18.948499, title: '8. Miejsce śmierci rtm. Jerzego Hollaka'},
                    {lat: 50.986457, lng: 18.937162, title: '9. Szarża 19.P.Uł'},
                    {lat: 50.96189966561543, lng: 18.91426577837677, title: '10. Muzeum w Mokrej'}
                ];
                points.forEach(function(p) {
                    L.marker([p.lat, p.lng]).addTo(map).bindPopup('<b>' + p.title + '</b>');
                });
                var latlngs = points.slice(0, 9).map(p => [p.lat, p.lng]);
                var polyline = L.polyline(latlngs, {color: 'red', weight: 4, opacity: 0.7}).addTo(map);
                function adjustMapView() {
                    map.setView([50.96, 18.92], 13);
                    map.fitBounds(polyline.getBounds());
                    map.invalidateSize();
                }
                adjustMapView();
                window.addEventListener('resize', adjustMapView);
                setTimeout(adjustMapView, 500);
                setTimeout(adjustMapView, 1000);
            } catch (error) {
                console.error('Error initializing Leaflet map:', error);
            }
        });
    </script>
</body>
</html>
